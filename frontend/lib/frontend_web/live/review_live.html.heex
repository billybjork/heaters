<%= if @page_state == :empty do %>
  <%# --- EMPTY STATE --- %>
  <div>
    <div>
      <button
        phx-click="undo"
        disabled={@history == []}
        aria-label="Go back to previous clip"
        title={if @history == [], do: "No previous clip", else: "Go back to previous clip"}>
        ⬅️
      </button>
    </div>

    <h2>
      All clips reviewed!
    </h2>

    <p>
      Check back later for more.
    </p>
  </div>
<% else %>
  <%# --- REVIEWING STATE --- %>
  <%= if @future != [] do %>
    <link
      rel="preload"
      as="image"
      href={@future |> List.first() |> sprite_url()} />
  <% end %>

  <div>
    <div>
      <.sprite_player clip={@current} />

      <div class="review-buttons">
        <button
          phx-click="undo"
          disabled={@history == []}
          aria-label="Go back to previous clip"
          title={if @history == [], do: "No previous clip", else: "Go back to previous clip"}>
          ⬅️
        </button>

        <button
          phx-click="select"
          phx-value-action="approve">
          ✅ Approve
        </button>

        <button
          phx-click="select"
          phx-value-action="skip">
          ➡️ Skip
        </button>

        <button
          phx-click="select"
          phx-value-action="archive">
          🗑️ Archive
        </button>

        <button
          phx-click="select"
          phx-value-action="merge"
          disabled={@history == []}
          title={if @history == [], do: "No previous clip to merge with", else: "Merge with previous clip"}>
          🔗 Merge (with previous)
        </button>

        <button
          phx-click="select"
          phx-value-action="group"
          disabled={@history == []}
          title={if @history == [], do: "No previous clip to group with", else: "Group with previous clip"}>
          🖇️ Group (with previous)
        </button>

        <!-- Split button (no phx-hook needed) -->
        <button
          id={"split-#{@current.id}"}
          data-clip-id={@current.id}>
          ✂️ Split
        </button>
      </div>
    </div>
  </div>
<% end %>